clean: cleanresults
	rm -rf output/*
	rm -rf ./_site/
	rm -f *.tmp

cleanresults:
	rm -rf results/*

#  Apps
output/apps/%: source/apps/%
	./run.py source/apps/$* > $@

apps-%.tmp: output/apps/apps-%
	./generate-table.py ./output/apps/apps-$* > $@
	./generate-page-result.py ./output/apps/apps-$*

results/apps/apps-%.markdown: apps-%.tmp generate-table.py
	cat _frontmatter/apps apps-$*.tmp > $@
	rm -f apps-$*.tmp


# Sites
output/sites/%: source/sites/%
	./run.py source/sites/$* > $@

sites-%.tmp: output/sites/%
	./generate-table.py ./output/sites/sites-$* > $@
	./generate-page-result.py ./output/sites/$*

results/sites/%.markdown: sites-%.tmp generate-table.py
	cat _frontmatter/$* sites-$*.tmp > $@
	rm -f sites-$*.tmp

# Main process

output/apps:
	mkdir -p output/apps/

output/sites:
	mkdir -p output/sites/

apps: output/apps results/apps/apps-aa.markdown results/apps/apps-ab.markdown results/apps/apps-ac.markdown results/apps/apps-ad.markdown results/apps/apps-ae.markdown results/apps/apps-af.markdown results/apps/apps-ag.markdown results/apps/apps-ah.markdown results/apps/apps-ai.markdown results/apps/apps-aj.markdown results/apps/apps-ak.markdown results/apps/apps-al.markdown results/apps/apps-am.markdown results/apps/apps-an.markdown results/apps/apps-ao.markdown results/apps/apps-ap.markdown results/apps/apps-aq.markdown results/apps/apps-ar.markdown results/apps/apps-as.markdown results/apps/apps-at.markdown results/apps/apps-au.markdown results/apps/apps-av.markdown results/apps/apps-aw.markdown results/apps/apps-ax.markdown results/apps/apps-ay.markdown results/apps/apps-az.markdown results/apps/apps-ba.markdown results/apps/apps-bb.markdown results/apps/apps-bc.markdown results/apps/apps-bd.markdown results/apps/apps-be.markdown results/apps/apps-bf.markdown results/apps/apps-bg.markdown results/apps/apps-bh.markdown results/apps/apps-bi.markdown results/apps/apps-bj.markdown results/apps/apps-bk.markdown results/apps/apps-bl.markdown results/apps/apps-bm.markdown results/apps/apps-bn.markdown results/apps/apps-bo.markdown results/apps/apps-bp.markdown results/apps/apps-bq.markdown results/apps/apps-br.markdown results/apps/apps-bs.markdown results/apps/apps-bt.markdown results/apps/apps-bu.markdown results/apps/apps-bv.markdown results/apps/apps-bw.markdown results/apps/apps-bx.markdown results/apps/apps-by.markdown results/apps/apps-bz.markdown results/apps/apps-ca.markdown results/apps/apps-cb.markdown results/apps/apps-cc.markdown results/apps/apps-cd.markdown results/apps/apps-ce.markdown results/apps/apps-cf.markdown results/apps/apps-cg.markdown results/apps/apps-ch.markdown results/apps/apps-ci.markdown results/apps/apps-cj.markdown results/apps/apps-ck.markdown results/apps/apps-cl.markdown results/apps/apps-cm.markdown results/apps/apps-cn.markdown results/apps/apps-co.markdown results/apps/apps-cp.markdown results/apps/apps-cq.markdown results/apps/apps-cr.markdown results/apps/apps-cs.markdown results/apps/apps-ct.markdown results/apps/apps-cu.markdown results/apps/apps-cv.markdown results/apps/apps-cw.markdown results/apps/apps-cx.markdown results/apps/apps-cy.markdown results/apps/apps-cz.markdown results/apps/apps-da.markdown results/apps/apps-db.markdown results/apps/apps-dc.markdown results/apps/apps-dd.markdown results/apps/apps-de.markdown results/apps/apps-df.markdown results/apps/apps-dg.markdown results/apps/apps-dh.markdown results/apps/apps-di.markdown results/apps/apps-dj.markdown results/apps/apps-dk.markdown results/apps/apps-dl.markdown results/apps/apps-dm.markdown results/apps/apps-dn.markdown results/apps/apps-do.markdown results/apps/apps-dp.markdown results/apps/apps-dq.markdown results/apps/apps-dr.markdown results/apps/apps-ds.markdown results/apps/apps-dt.markdown results/apps/apps-du.markdown results/apps/apps-dv.markdown results/apps/apps-dw.markdown results/apps/apps-dx.markdown results/apps/apps-dy.markdown results/apps/apps-dz.markdown results/apps/apps-ea.markdown results/apps/apps-eb.markdown results/apps/apps-ec.markdown results/apps/apps-ed.markdown results/apps/apps-ee.markdown results/apps/apps-ef.markdown results/apps/apps-eg.markdown results/apps/apps-eh.markdown results/apps/apps-ei.markdown results/apps/apps-ej.markdown results/apps/apps-ek.markdown results/apps/apps-el.markdown results/apps/apps-em.markdown results/apps/apps-en.markdown results/apps/apps-eo.markdown results/apps/apps-ep.markdown results/apps/apps-eq.markdown results/apps/apps-er.markdown results/apps/apps-es.markdown results/apps/apps-et.markdown results/apps/apps-eu.markdown results/apps/apps-ev.markdown results/apps/apps-ew.markdown results/apps/apps-ex.markdown results/apps/apps-ey.markdown results/apps/apps-ez.markdown results/apps/apps-fa.markdown results/apps/apps-fb.markdown results/apps/apps-fc.markdown results/apps/apps-fd.markdown results/apps/apps-fe.markdown results/apps/apps-ff.markdown results/apps/apps-fg.markdown results/apps/apps-fh.markdown results/apps/apps-fi.markdown results/apps/apps-fj.markdown results/apps/apps-fk.markdown results/apps/apps-fl.markdown results/apps/apps-fm.markdown results/apps/apps-fn.markdown results/apps/apps-fo.markdown results/apps/apps-fp.markdown results/apps/apps-fq.markdown results/apps/apps-fr.markdown results/apps/apps-fs.markdown results/apps/apps-ft.markdown results/apps/apps-fu.markdown results/apps/apps-fv.markdown results/apps/apps-fw.markdown results/apps/apps-fx.markdown results/apps/apps-fy.markdown results/apps/apps-fz.markdown results/apps/apps-ga.markdown results/apps/apps-gb.markdown results/apps/apps-gc.markdown results/apps/apps-gd.markdown results/apps/apps-ge.markdown results/apps/apps-gf.markdown results/apps/apps-gg.markdown results/apps/apps-gh.markdown results/apps/apps-gi.markdown results/apps/apps-gj.markdown results/apps/apps-gk.markdown results/apps/apps-gl.markdown results/apps/apps-gm.markdown results/apps/apps-gn.markdown results/apps/apps-go.markdown results/apps/apps-gp.markdown results/apps/apps-gq.markdown results/apps/apps-gr.markdown results/apps/apps-gs.markdown results/apps/apps-gt.markdown results/apps/apps-gu.markdown results/apps/apps-gv.markdown results/apps/apps-gw.markdown results/apps/apps-gx.markdown results/apps/apps-gy.markdown results/apps/apps-gz.markdown results/apps/apps-ha.markdown results/apps/apps-hb.markdown results/apps/apps-hc.markdown results/apps/apps-hd.markdown results/apps/apps-he.markdown results/apps/apps-hf.markdown results/apps/apps-hg.markdown results/apps/apps-hh.markdown results/apps/apps-hi.markdown results/apps/apps-hj.markdown results/apps/apps-hk.markdown results/apps/apps-hl.markdown results/apps/apps-hm.markdown results/apps/apps-hn.markdown results/apps/apps-ho.markdown results/apps/apps-hp.markdown results/apps/apps-hq.markdown results/apps/apps-hr.markdown results/apps/apps-hs.markdown results/apps/apps-ht.markdown results/apps/apps-hu.markdown results/apps/apps-hv.markdown results/apps/apps-hw.markdown results/apps/apps-hx.markdown results/apps/apps-hy.markdown results/apps/apps-hz.markdown results/apps/apps-ia.markdown results/apps/apps-ib.markdown results/apps/apps-ic.markdown results/apps/apps-id.markdown results/apps/apps-ie.markdown results/apps/apps-if.markdown results/apps/apps-ig.markdown results/apps/apps-ih.markdown results/apps/apps-ii.markdown results/apps/apps-ij.markdown results/apps/apps-ik.markdown results/apps/apps-il.markdown results/apps/apps-im.markdown results/apps/apps-in.markdown results/apps/apps-io.markdown results/apps/apps-ip.markdown results/apps/apps-iq.markdown results/apps/apps-ir.markdown results/apps/apps-is.markdown results/apps/apps-it.markdown results/apps/apps-iu.markdown results/apps/apps-iv.markdown results/apps/apps-iw.markdown results/apps/apps-ix.markdown results/apps/apps-iy.markdown results/apps/apps-iz.markdown results/apps/apps-ja.markdown results/apps/apps-jb.markdown results/apps/apps-jc.markdown results/apps/apps-jd.markdown results/apps/apps-je.markdown results/apps/apps-jf.markdown results/apps/apps-jg.markdown results/apps/apps-jh.markdown results/apps/apps-ji.markdown results/apps/apps-jj.markdown results/apps/apps-jk.markdown results/apps/apps-jl.markdown results/apps/apps-jm.markdown results/apps/apps-jn.markdown results/apps/apps-jo.markdown results/apps/apps-jp.markdown results/apps/apps-jq.markdown results/apps/apps-jr.markdown results/apps/apps-js.markdown results/apps/apps-jt.markdown results/apps/apps-ju.markdown results/apps/apps-jv.markdown results/apps/apps-jw.markdown results/apps/apps-jx.markdown results/apps/apps-jy.markdown results/apps/apps-jz.markdown results/apps/apps-ka.markdown results/apps/apps-kb.markdown results/apps/apps-kc.markdown results/apps/apps-kd.markdown results/apps/apps-ke.markdown results/apps/apps-kf.markdown results/apps/apps-kg.markdown results/apps/apps-kh.markdown results/apps/apps-ki.markdown results/apps/apps-kj.markdown results/apps/apps-kk.markdown results/apps/apps-kl.markdown results/apps/apps-km.markdown results/apps/apps-kn.markdown results/apps/apps-ko.markdown results/apps/apps-kp.markdown results/apps/apps-kq.markdown results/apps/apps-kr.markdown results/apps/apps-ks.markdown results/apps/apps-kt.markdown results/apps/apps-ku.markdown results/apps/apps-kv.markdown results/apps/apps-kw.markdown results/apps/apps-kx.markdown results/apps/apps-ky.markdown results/apps/apps-kz.markdown results/apps/apps-la.markdown results/apps/apps-lb.markdown results/apps/apps-lc.markdown results/apps/apps-ld.markdown results/apps/apps-le.markdown results/apps/apps-lf.markdown results/apps/apps-lg.markdown results/apps/apps-lh.markdown results/apps/apps-li.markdown results/apps/apps-lj.markdown results/apps/apps-lk.markdown results/apps/apps-ll.markdown results/apps/apps-lm.markdown results/apps/apps-ln.markdown results/apps/apps-lo.markdown results/apps/apps-lp.markdown results/apps/apps-lq.markdown results/apps/apps-lr.markdown results/apps/apps-ls.markdown results/apps/apps-lt.markdown results/apps/apps-lu.markdown results/apps/apps-lv.markdown results/apps/apps-lw.markdown results/apps/apps-lx.markdown results/apps/apps-ly.markdown results/apps/apps-lz.markdown results/apps/apps-ma.markdown results/apps/apps-mb.markdown results/apps/apps-mc.markdown results/apps/apps-md.markdown results/apps/apps-me.markdown results/apps/apps-mf.markdown results/apps/apps-mg.markdown results/apps/apps-mh.markdown results/apps/apps-mi.markdown results/apps/apps-mj.markdown results/apps/apps-mk.markdown results/apps/apps-ml.markdown results/apps/apps-mm.markdown results/apps/apps-mn.markdown results/apps/apps-mo.markdown results/apps/apps-mp.markdown results/apps/apps-mq.markdown results/apps/apps-mr.markdown results/apps/apps-ms.markdown results/apps/apps-mt.markdown results/apps/apps-mu.markdown results/apps/apps-mv.markdown results/apps/apps-mw.markdown results/apps/apps-mx.markdown results/apps/apps-my.markdown results/apps/apps-mz.markdown results/apps/apps-na.markdown results/apps/apps-nb.markdown results/apps/apps-nc.markdown results/apps/apps-nd.markdown results/apps/apps-ne.markdown results/apps/apps-nf.markdown results/apps/apps-ng.markdown results/apps/apps-nh.markdown results/apps/apps-ni.markdown results/apps/apps-nj.markdown results/apps/apps-nk.markdown results/apps/apps-nl.markdown results/apps/apps-nm.markdown results/apps/apps-nn.markdown results/apps/apps-no.markdown results/apps/apps-np.markdown results/apps/apps-nq.markdown results/apps/apps-nr.markdown results/apps/apps-ns.markdown results/apps/apps-nt.markdown results/apps/apps-nu.markdown results/apps/apps-nv.markdown results/apps/apps-nw.markdown results/apps/apps-nx.markdown results/apps/apps-ny.markdown results/apps/apps-nz.markdown results/apps/apps-oa.markdown results/apps/apps-ob.markdown results/apps/apps-oc.markdown results/apps/apps-od.markdown results/apps/apps-oe.markdown results/apps/apps-of.markdown results/apps/apps-og.markdown results/apps/apps-oh.markdown results/apps/apps-oi.markdown results/apps/apps-oj.markdown results/apps/apps-ok.markdown results/apps/apps-ol.markdown results/apps/apps-om.markdown results/apps/apps-on.markdown results/apps/apps-oo.markdown results/apps/apps-op.markdown results/apps/apps-oq.markdown results/apps/apps-or.markdown results/apps/apps-os.markdown results/apps/apps-ot.markdown results/apps/apps-ou.markdown results/apps/apps-ov.markdown results/apps/apps-ow.markdown results/apps/apps-ox.markdown results/apps/apps-oy.markdown results/apps/apps-oz.markdown results/apps/apps-pa.markdown results/apps/apps-pb.markdown results/apps/apps-pc.markdown results/apps/apps-pd.markdown results/apps/apps-pe.markdown results/apps/apps-pf.markdown results/apps/apps-pg.markdown results/apps/apps-ph.markdown results/apps/apps-pi.markdown results/apps/apps-pj.markdown results/apps/apps-pk.markdown results/apps/apps-pl.markdown results/apps/apps-pm.markdown results/apps/apps-pn.markdown results/apps/apps-po.markdown results/apps/apps-pp.markdown results/apps/apps-pq.markdown results/apps/apps-pr.markdown results/apps/apps-ps.markdown results/apps/apps-pt.markdown results/apps/apps-pu.markdown results/apps/apps-pv.markdown results/apps/apps-pw.markdown results/apps/apps-px.markdown results/apps/apps-py.markdown results/apps/apps-pz.markdown results/apps/apps-qa.markdown results/apps/apps-qb.markdown results/apps/apps-qc.markdown results/apps/apps-qd.markdown results/apps/apps-qe.markdown results/apps/apps-qf.markdown results/apps/apps-qg.markdown results/apps/apps-qh.markdown results/apps/apps-qi.markdown results/apps/apps-qj.markdown results/apps/apps-qk.markdown results/apps/apps-ql.markdown results/apps/apps-qm.markdown results/apps/apps-qn.markdown results/apps/apps-qo.markdown results/apps/apps-qp.markdown results/apps/apps-qq.markdown results/apps/apps-qr.markdown results/apps/apps-qs.markdown results/apps/apps-qt.markdown results/apps/apps-qu.markdown results/apps/apps-qv.markdown results/apps/apps-qw.markdown results/apps/apps-qx.markdown results/apps/apps-qy.markdown results/apps/apps-qz.markdown results/apps/apps-ra.markdown results/apps/apps-rb.markdown results/apps/apps-rc.markdown results/apps/apps-rd.markdown results/apps/apps-re.markdown results/apps/apps-rf.markdown results/apps/apps-rg.markdown results/apps/apps-rh.markdown results/apps/apps-ri.markdown results/apps/apps-rj.markdown results/apps/apps-rk.markdown results/apps/apps-rl.markdown results/apps/apps-rm.markdown results/apps/apps-rn.markdown results/apps/apps-ro.markdown results/apps/apps-rp.markdown results/apps/apps-rq.markdown results/apps/apps-rr.markdown results/apps/apps-rs.markdown results/apps/apps-rt.markdown results/apps/apps-ru.markdown results/apps/apps-rv.markdown results/apps/apps-rw.markdown results/apps/apps-rx.markdown results/apps/apps-ry.markdown results/apps/apps-rz.markdown results/apps/apps-sa.markdown results/apps/apps-sb.markdown results/apps/apps-sc.markdown results/apps/apps-sd.markdown results/apps/apps-se.markdown results/apps/apps-sf.markdown results/apps/apps-sg.markdown results/apps/apps-sh.markdown results/apps/apps-si.markdown results/apps/apps-sj.markdown results/apps/apps-sk.markdown results/apps/apps-sl.markdown results/apps/apps-sm.markdown results/apps/apps-sn.markdown results/apps/apps-so.markdown results/apps/apps-sp.markdown results/apps/apps-sq.markdown results/apps/apps-sr.markdown results/apps/apps-ss.markdown results/apps/apps-st.markdown results/apps/apps-su.markdown results/apps/apps-sv.markdown results/apps/apps-sw.markdown results/apps/apps-sx.markdown results/apps/apps-sy.markdown results/apps/apps-sz.markdown results/apps/apps-ta.markdown results/apps/apps-tb.markdown results/apps/apps-tc.markdown results/apps/apps-td.markdown results/apps/apps-te.markdown

sites: output/sites results/sites/singapore-top-100.markdown results/sites/philippines-top-100.markdown results/sites/malaysian-top-100.markdown results/sites/indonesian-top-100.markdown results/sites/nigerian-top-100.markdown results/sites/kenyan-top-100.markdown results/sites/south-african-top-100.markdown results/sites/indian-top-100.markdown results/sites/dutch-top-100.markdown results/sites/danish-top-100.markdown results/sites/romainian-top-100.markdown results/sites/polish-top-100.markdown results/sites/czech-republic-top-100.markdown results/sites/italian-top-100.markdown results/sites/spanish-top-100.markdown results/sites/computers.markdown results/sites/sports.markdown results/sites/south-korean-top-100.markdown results/sites/shopping.markdown results/sites/thai-top-100.markdown results/sites/german-top-100.markdown results/sites/uk-top-100.markdown results/sites/japanese-top-100.markdown results/sites/french-top-100.markdown results/sites/wordpress.markdown results/sites/news.markdown results/sites/themeforest-livepopular.markdown results/sites/alexa-top-10.markdown results/sites/webdeveloperdocs.markdown

mergepsi: sites apps 

build: mergepsi

deploy: build
	git push origin gh-pages

server:
	jekyll serve -w --trace $(param1)